// Initialize Firebase
var config = {
  //apiKey: "AIzaSyAcBrYW5voDEph11uBk3WawMRTKmUK5V-Q",
  apiKey: {{env('FIREBASE_APIKEY')}},
  authDomain: {{env('FIREBASE_AUTHDOMAIN')}},
  databaseURL: {{env('FIREBASE_DB')}},
  projectId: {{env('FIREBASE_PROJECT_ID')}},
  storageBucket: {{env('FIREBASE_STORAGE_BUCKET')}},
  messagingSenderId: {{env('FIREBASE_SENDER_ID')}}
};

var image = "images/car.svg";                      

firebase.initializeApp(config);
var firebaseRef = firebase.database().ref();
var map ;
var marker = [];
map = new google.maps.Map(document.getElementById('map'), {
    center: {
      lat: 0,
      lng: 0
    },
    zoom: 2,
    styles: [{
      featureType: 'poi',
      stylers: [{
          visibility: 'off'
        }] // Turn off points of interest.
    }, {
      featureType: 'transit.station',
      stylers: [{
          visibility: 'off'
        }] // Turn off bus stations, train stations, etc.
    }],
    disableDoubleClickZoom: false,
       mapTypeId: google.maps.MapTypeId.ROADMAP,
      streetViewControl: true,
       mapTypeControlOptions: {
        position: google.maps.ControlPosition.RIGHT_TOP
      },
      zoomControlOptions: {
         position: google.maps.ControlPosition.RIGHT_BOTTOM
     }
});

var baseurl = {{env('APP_URL')}};
var markers = [];
var markers_name = [];
var markers_temp = [];
var vector_arr = ["M 0.99,167.44 C 3.19,163.72 11.69,159.34 13.98,154.96 15.19,152.64 14.99,149.57 15.00,147.00 15.00,147.00 15.00,93.00 15.00,93.00 15.02,80.90 17.60,84.07 18.66,78.00 18.66,78.00 18.00,66.00 18.00,66.00 17.93,48.93 23.60,35.45 37.00,24.46 50.20,13.64 66.63,7.70 83.00,3.63 88.68,2.21 98.36,-0.14 104.00,0.04 116.98,0.46 140.31,7.92 152.00,13.75 171.87,23.67 187.89,38.27 188.00,62.00 188.00,62.00 188.00,72.00 188.00,72.00 187.85,86.82 190.97,79.32 191.00,92.00 191.00,92.00 191.00,147.00 191.00,147.00 191.01,149.52 190.80,152.65 192.02,154.91 194.25,159.04 202.67,163.02 204.98,167.17 206.43,169.78 206.00,175.88 206.00,179.00 206.00,179.00 184.00,171.00 184.00,171.00 184.00,171.00 184.00,295.00 184.00,295.00 184.03,311.12 190.97,299.53 191.00,316.00 191.00,316.00 191.00,381.00 191.00,381.00 191.00,383.67 191.22,387.44 189.83,389.78 188.49,392.02 185.13,393.55 183.00,395.27 172.96,403.33 170.42,405.31 158.00,409.66 140.79,415.68 118.22,421.21 100.00,421.00 89.49,420.87 61.34,414.23 51.00,410.66 39.45,406.66 32.66,403.36 23.42,395.28 17.42,390.03 15.02,393.24 15.00,381.00 15.00,381.00 15.00,317.00 15.00,317.00 15.00,314.24 14.79,310.57 16.17,308.13 17.83,305.21 20.58,304.77 21.98,302.59 23.23,300.65 23.00,297.27 23.00,295.00 23.00,295.00 23.00,171.00 23.00,171.00 23.00,171.00 0.00,179.00 0.00,179.00 0.00,176.02 -0.46,169.89 0.99,167.44 Z M 76.00,16.00 C 46.63,35.47 32.05,71.52 32.00,106.00 31.99,110.94 31.28,119.67 33.00,124.00 33.68,93.10 45.40,54.27 66.17,31.00 71.52,25.01 77.46,19.57 84.00,14.91 88.27,11.86 93.28,9.72 97.00,6.00 89.76,7.70 82.18,11.91 76.00,16.00 Z M 174.00,103.00 C 173.96,75.34 162.36,44.12 142.00,25.09 136.36,19.82 127.92,13.83 121.00,10.37 117.76,8.75 114.60,7.09 111.00,8.00 142.17,25.95 159.02,51.57 167.63,86.00 167.63,86.00 171.84,108.00 171.84,108.00 172.26,111.95 172.71,120.76 174.00,124.00 174.00,124.00 174.00,103.00 174.00,103.00 Z M 60.85,62.00 C 60.85,62.00 65.72,104.00 65.72,104.00 67.59,119.20 65.83,120.74 74.00,121.00 74.00,121.00 60.00,41.00 60.00,41.00 58.06,45.88 60.18,56.44 60.85,62.00 Z M 141.92,68.00 C 141.92,68.00 132.00,120.00 132.00,120.00 132.00,120.00 139.00,121.00 139.00,121.00 139.00,121.00 141.72,96.00 141.72,96.00 141.72,96.00 146.16,56.00 146.16,56.00 146.16,56.00 148.00,41.00 148.00,41.00 145.17,45.84 142.99,61.70 141.92,68.00 Z M 50.00,135.43 C 47.27,136.21 39.59,138.54 38.12,140.70 35.74,143.73 37.62,155.22 38.12,159.00 38.12,159.00 44.87,190.00 44.87,190.00 45.69,193.26 47.01,200.09 49.51,202.26 51.88,204.33 56.02,204.00 59.00,204.00 59.00,204.00 81.00,204.00 81.00,204.00 81.00,204.00 98.00,203.04 98.00,203.04 98.00,203.04 114.00,203.04 114.00,203.04 114.00,203.04 124.00,204.00 124.00,204.00 124.00,204.00 147.00,204.00 147.00,204.00 150.06,204.00 154.09,204.32 156.58,202.26 159.18,200.13 160.37,194.25 161.29,191.00 161.29,191.00 168.13,159.00 168.13,159.00 168.77,154.83 170.90,143.87 168.13,140.65 165.44,137.41 152.47,134.47 148.00,133.37 131.44,129.31 102.00,127.70 85.00,129.28 73.20,130.98 61.54,132.12 50.00,135.43 Z M 30.00,197.00 C 30.00,197.00 30.00,254.00 30.00,254.00 33.99,250.62 40.85,241.01 42.35,236.00 43.04,233.71 42.99,231.36 43.00,229.00 43.10,209.87 40.58,187.84 31.00,171.00 31.00,171.00 30.00,197.00 30.00,197.00 Z M 166.88,194.00 C 164.57,203.77 162.88,217.98 163.00,228.00 163.12,237.29 169.30,247.78 176.00,254.00 176.00,254.00 176.00,171.00 176.00,171.00 170.41,177.21 168.76,186.09 166.88,194.00 Z M 51.31,218.22 C 50.09,220.31 50.03,223.60 49.72,226.00 49.72,226.00 48.00,246.00 48.00,246.00 48.00,246.00 48.00,301.00 48.00,301.00 48.00,301.00 50.02,330.00 50.02,330.00 50.55,337.78 53.12,359.43 58.39,364.70 61.01,367.32 65.45,368.00 69.00,368.56 69.00,368.56 95.00,371.00 95.00,371.00 107.47,371.14 119.62,370.63 132.00,369.15 136.22,368.65 143.50,368.04 146.87,365.44 153.32,360.45 155.30,340.09 156.00,332.00 156.00,332.00 158.00,297.00 158.00,297.00 158.00,297.00 159.00,280.00 159.00,280.00 159.00,280.00 158.00,243.00 158.00,243.00 157.99,238.24 156.93,220.63 154.26,217.42 151.20,213.72 138.83,211.60 134.00,211.05 122.03,209.69 89.86,209.18 78.00,210.28 71.74,211.19 54.63,212.57 51.31,218.22 Z M 105.00,217.96 C 105.00,217.96 114.00,217.08 114.00,217.08 114.00,217.08 134.00,218.92 134.00,218.92 137.53,219.51 146.89,221.16 149.18,223.70 151.99,226.83 151.75,238.64 152.17,243.00 152.17,243.00 153.00,299.00 153.00,299.00 153.00,299.00 152.00,309.00 152.00,309.00 152.00,309.00 152.00,318.00 152.00,318.00 152.00,318.00 148.39,345.00 148.39,345.00 146.74,353.57 145.62,359.35 136.00,360.87 136.00,360.87 102.00,363.96 102.00,363.96 102.00,363.96 82.00,362.17 82.00,362.17 76.85,361.65 66.29,361.43 62.65,357.57 57.75,352.40 56.53,336.16 55.58,329.00 55.58,329.00 54.00,306.00 54.00,306.00 54.00,306.00 53.00,290.00 53.00,290.00 53.00,290.00 53.00,262.00 53.00,262.00 53.00,262.00 54.00,242.00 54.00,242.00 54.05,238.44 54.98,227.01 56.93,224.42 58.63,222.16 62.38,221.17 65.00,220.43 75.47,217.47 78.96,218.71 88.00,217.42 96.59,216.38 97.56,218.25 105.00,217.96 Z M 30.00,269.00 C 30.00,269.00 30.00,321.00 30.00,321.00 30.00,326.66 29.18,340.40 31.00,345.00 33.72,338.60 35.87,328.02 37.42,321.00 39.85,309.99 42.98,294.11 43.00,283.00 43.00,283.00 43.00,258.00 43.00,258.00 32.15,258.91 30.02,259.57 30.00,269.00 Z M 176.00,269.00 C 175.98,259.57 173.85,258.91 163.00,258.00 163.00,285.30 162.84,294.70 169.12,322.00 170.64,328.61 172.31,339.56 176.00,345.00 176.00,345.00 176.00,269.00 176.00,269.00 Z M 56.04,388.81 C 62.14,391.79 70.31,392.45 77.00,393.16 77.00,393.16 120.00,394.00 120.00,394.00 126.19,393.92 138.96,392.18 145.00,390.62 148.36,389.76 152.10,388.74 154.26,385.79 157.69,381.10 154.99,373.58 149.00,372.90 146.57,372.62 140.23,375.12 137.00,375.74 128.39,377.38 119.74,377.92 111.00,378.00 98.93,378.13 87.02,378.21 75.00,376.71 65.06,375.48 63.18,373.57 58.00,372.78 48.86,374.54 47.50,384.65 56.04,388.81 Z","M 24.85,49.00 C 27.10,42.31 43.52,24.77 49.04,19.00 52.43,15.46 63.12,4.03 67.00,2.60 69.32,1.75 73.41,2.07 76.00,1.96 76.00,1.96 93.00,1.00 93.00,1.00 93.00,1.00 108.00,0.00 108.00,0.00 108.00,0.00 129.00,0.00 129.00,0.00 129.00,0.00 143.00,1.00 143.00,1.00 143.00,1.00 168.00,2.60 168.00,2.60 171.76,3.98 178.87,11.87 182.00,15.00 182.00,15.00 201.05,35.00 201.05,35.00 204.00,38.33 208.89,43.81 210.30,48.00 211.13,50.45 211.00,53.42 211.00,56.00 211.00,56.00 211.00,82.00 211.00,82.00 220.25,82.12 220.98,84.24 221.00,93.00 221.00,93.00 221.00,141.00 221.00,141.00 220.95,149.00 219.06,150.55 211.00,151.00 211.00,154.53 210.36,160.83 212.60,163.61 215.65,167.40 232.68,173.30 235.01,176.63 236.42,178.66 236.00,184.43 236.00,187.00 236.00,187.00 207.00,181.00 207.00,181.00 207.00,181.00 207.00,245.00 207.00,245.00 206.98,256.08 204.75,252.06 203.15,258.04 203.15,258.04 203.15,268.00 203.15,268.00 203.15,268.00 205.98,269.59 205.98,269.59 205.98,269.59 207.00,289.00 207.00,289.00 207.00,289.00 207.00,353.00 207.00,353.00 210.12,353.01 214.83,352.52 216.83,355.43 218.58,357.98 218.00,367.56 218.00,371.00 218.00,371.00 218.00,411.00 218.00,411.00 217.95,420.72 216.20,420.97 207.00,421.00 205.43,434.96 186.08,445.92 174.00,450.31 142.48,461.75 97.93,462.09 66.00,451.97 52.70,447.76 30.12,436.66 29.00,421.00 26.09,420.97 21.89,421.29 20.02,418.57 18.45,416.29 19.00,406.21 19.00,403.00 19.00,403.00 19.00,363.00 19.00,363.00 19.02,354.02 19.88,353.09 29.00,353.00 29.00,353.00 29.00,268.00 29.00,268.00 29.00,268.00 32.00,268.00 32.00,268.00 32.00,268.00 29.00,246.00 29.00,246.00 29.00,246.00 29.00,181.00 29.00,181.00 29.00,181.00 0.00,187.00 0.00,187.00 0.00,187.00 0.57,177.39 0.57,177.39 0.57,177.39 7.00,172.42 7.00,172.42 7.00,172.42 24.00,165.00 24.00,165.00 24.00,165.00 24.00,151.00 24.00,151.00 16.73,149.78 16.05,148.05 16.00,141.00 16.00,141.00 16.00,92.00 16.00,92.00 16.01,84.67 15.91,82.48 24.00,82.00 24.00,75.72 23.34,53.50 24.85,49.00 Z M 74.20,40.00 C 74.20,40.00 64.58,79.00 64.58,79.00 64.58,79.00 52.57,109.00 52.57,109.00 52.57,109.00 41.00,127.00 41.00,127.00 53.09,126.29 58.63,112.88 62.55,103.00 70.59,82.74 77.99,39.99 79.00,18.00 79.00,18.00 74.20,40.00 74.20,40.00 Z M 159.05,41.00 C 161.06,59.00 167.09,89.73 174.31,106.00 177.97,114.25 183.87,128.81 195.00,126.00 189.10,117.65 185.90,114.87 180.97,105.00 173.54,90.15 169.14,73.06 165.13,57.00 162.84,47.87 158.41,26.88 158.00,18.00 156.01,23.02 158.40,35.17 159.05,41.00 Z M 195.86,155.00 C 196.51,152.73 198.06,148.42 197.31,146.21 196.33,143.30 190.65,140.62 188.00,139.26 179.12,134.70 169.64,131.41 160.00,128.88 128.35,120.57 94.99,121.62 64.00,132.34 53.83,135.86 46.44,140.46 37.00,145.00 37.00,145.00 47.00,178.00 47.00,178.00 47.00,178.00 38.00,178.00 38.00,178.00 38.00,178.00 38.00,303.00 38.00,303.00 38.00,327.54 35.27,349.53 52.32,370.00 72.00,393.62 98.81,394.33 127.00,394.00 154.20,393.68 179.21,382.55 191.22,357.00 195.13,348.68 196.99,341.18 197.00,332.00 197.00,332.00 197.00,178.00 197.00,178.00 197.00,178.00 188.00,178.00 188.00,178.00 188.00,178.00 195.86,155.00 195.86,155.00 Z M 181.68,184.00 C 180.56,187.02 177.84,195.31 175.36,197.09 173.16,198.51 169.51,197.41 167.00,197.09 167.00,197.09 150.00,196.00 150.00,196.00 150.00,196.00 133.00,195.00 133.00,195.00 133.00,195.00 102.00,195.00 102.00,195.00 102.00,195.00 84.00,196.01 84.00,196.01 84.00,196.01 68.00,197.07 68.00,197.07 65.59,197.39 62.59,198.31 60.39,197.07 57.01,194.89 52.16,179.34 50.66,175.00 50.66,175.00 44.67,157.00 44.67,157.00 43.93,154.77 42.15,150.41 42.78,148.18 43.99,143.91 55.01,140.00 59.00,138.40 75.22,131.91 98.52,127.21 116.00,127.00 134.44,126.79 159.90,131.53 177.00,138.45 177.00,138.45 194.00,147.00 194.00,147.00 194.00,147.00 181.68,184.00 181.68,184.00 Z M 69.00,201.04 C 69.00,201.04 88.00,199.91 88.00,199.91 88.00,199.91 98.00,199.20 98.00,199.20 100.29,198.98 103.83,198.91 106.00,199.20 118.76,202.17 116.99,218.60 113.56,228.00 112.54,230.80 109.92,235.29 110.05,238.00 110.14,240.03 112.47,244.71 113.31,247.00 116.50,255.77 115.47,253.68 115.10,262.00 114.86,267.38 117.34,272.86 108.00,276.24 97.61,279.99 76.82,281.20 66.00,279.00 59.20,277.61 53.08,275.71 51.48,268.00 50.31,262.32 53.28,252.35 55.45,247.00 56.85,243.55 59.55,239.77 58.83,236.00 58.83,236.00 56.01,229.00 56.01,229.00 52.95,221.48 48.21,203.94 57.00,199.00 61.40,203.32 63.38,201.31 69.00,201.04 Z M 180.82,226.00 C 180.82,226.00 176.37,236.58 176.37,236.58 176.15,238.77 178.78,243.80 179.72,246.00 182.06,251.52 183.85,256.96 183.99,263.00 184.06,266.30 184.22,270.07 182.26,272.89 179.66,276.65 174.27,278.10 170.00,278.93 160.05,280.79 149.98,280.11 140.00,278.93 135.91,278.47 127.33,276.69 124.11,274.30 116.05,268.32 119.28,254.90 122.23,247.00 123.07,244.75 125.43,240.01 125.55,238.00 125.73,235.18 123.13,230.83 122.06,228.00 118.71,219.13 117.21,202.40 129.00,199.53 131.57,198.91 135.31,198.97 138.00,199.00 138.00,199.00 167.00,201.04 167.00,201.04 172.83,201.30 174.34,203.33 179.00,199.00 179.00,199.00 180.82,199.00 180.82,199.00 184.41,207.19 183.43,217.72 180.82,226.00 Z M 115.30,336.00 C 115.30,336.00 115.30,343.00 115.30,343.00 115.06,348.32 116.68,351.25 110.96,355.30 105.97,358.82 87.49,360.84 81.00,360.99 75.20,361.12 74.37,360.66 69.00,360.05 65.58,359.66 63.26,359.40 60.00,358.07 46.82,352.71 51.15,338.30 55.20,328.00 56.15,325.60 58.83,320.20 58.87,318.00 58.92,315.64 56.37,310.51 55.42,308.00 53.69,303.41 52.37,297.91 52.09,293.00 51.92,290.00 52.25,282.73 55.31,281.20 57.41,280.16 61.72,281.83 64.00,282.34 71.42,283.99 75.51,284.08 83.00,284.00 86.90,283.95 95.11,282.94 99.00,282.20 101.97,281.63 106.09,280.29 108.98,281.18 113.98,282.71 115.11,287.42 115.71,292.00 116.99,301.73 113.60,311.17 108.00,319.00 112.05,323.06 115.25,330.20 115.30,336.00 Z M 183.00,293.00 C 182.97,299.69 182.25,302.77 179.80,309.00 178.91,311.25 176.24,316.18 176.43,318.28 176.59,319.98 178.79,324.12 179.55,326.00 181.77,331.50 183.85,338.05 183.99,344.00 184.05,346.85 184.17,350.29 182.69,352.82 180.26,356.94 174.43,358.72 170.00,359.39 159.35,361.51 148.65,360.99 138.00,359.39 133.75,358.55 127.66,357.47 124.11,355.01 111.97,346.59 124.96,322.01 125.38,320.00 126.13,316.39 123.12,311.58 121.86,308.00 119.96,302.57 119.94,299.64 120.00,294.00 120.06,289.42 120.29,284.16 125.11,282.01 129.17,280.19 142.85,283.10 148.00,283.72 159.36,285.06 167.14,283.32 177.96,280.74 184.40,281.21 183.02,288.03 183.00,293.00 Z M 44.00,417.00 C 44.00,420.74 43.71,428.65 44.71,431.91 45.93,435.89 48.34,436.82 52.00,438.00 52.00,438.00 52.00,404.00 52.00,404.00 52.00,393.71 54.21,389.98 46.00,383.00 43.83,388.48 44.00,410.05 44.00,417.00 Z M 184.00,395.00 C 184.00,395.00 184.00,438.00 184.00,438.00 191.04,435.21 190.99,432.97 191.00,426.00 191.00,426.00 191.00,383.00 191.00,383.00 184.77,385.99 184.04,388.44 184.00,395.00 Z","M 21.00,62.00 C 20.75,40.34 29.70,27.86 46.00,14.28 50.04,10.92 58.16,4.54 63.00,2.99 68.10,1.36 76.58,1.28 82.00,0.91 82.00,0.91 93.00,0.00 93.00,0.00 93.00,0.00 128.00,0.00 128.00,0.00 133.00,0.06 154.02,1.81 158.00,3.34 162.20,4.95 168.43,9.73 172.00,12.61 182.59,21.17 193.09,31.58 197.23,45.00 200.69,56.24 198.24,65.01 198.00,76.00 204.63,76.54 205.88,78.51 206.00,85.00 206.00,85.00 206.00,137.00 206.00,137.00 206.03,149.76 210.54,147.09 216.52,157.00 220.34,163.34 220.00,166.99 220.00,174.00 220.00,174.00 198.00,166.00 198.00,166.00 198.00,166.00 198.00,353.00 198.00,353.00 204.63,353.54 205.88,355.51 206.00,362.00 206.00,362.00 206.00,418.00 206.00,418.00 205.99,425.49 206.26,428.41 198.00,430.00 197.77,455.62 177.70,475.96 152.00,476.00 152.00,476.00 68.00,476.00 68.00,476.00 42.48,475.96 22.23,455.45 22.00,430.00 15.55,428.62 14.12,426.46 14.00,420.00 14.00,420.00 14.00,362.00 14.00,362.00 14.12,355.51 15.37,353.54 22.00,353.00 22.00,353.00 22.00,166.00 22.00,166.00 16.08,168.75 6.26,173.35 0.00,174.00 0.00,166.99 -0.34,163.34 3.48,157.00 9.46,147.09 13.97,149.76 14.00,137.00 14.00,137.00 14.00,86.00 14.00,86.00 14.05,79.20 14.62,76.60 22.00,76.00 22.00,76.00 21.00,62.00 21.00,62.00 Z M 60.00,47.00 C 60.00,47.00 60.00,74.00 60.00,74.00 60.00,74.00 68.00,74.00 68.00,74.00 68.00,74.00 68.00,47.00 68.00,47.00 68.00,47.00 60.00,47.00 60.00,47.00 Z M 70.00,47.00 C 70.00,47.00 77.79,61.00 77.79,61.00 77.79,61.00 71.00,74.00 71.00,74.00 79.08,73.97 80.28,73.56 84.00,66.00 89.14,73.20 89.24,73.97 98.00,74.00 98.00,74.00 90.47,60.58 90.47,60.58 90.47,60.58 98.00,47.00 98.00,47.00 89.97,47.03 88.85,47.55 85.00,55.00 77.99,46.86 79.65,47.01 70.00,47.00 Z M 102.00,47.00 C 102.00,47.00 111.00,74.00 111.00,74.00 111.00,74.00 120.49,72.98 120.49,72.98 120.49,72.98 124.19,66.00 124.19,66.00 124.19,66.00 131.00,47.00 131.00,47.00 125.59,47.02 123.35,46.12 122.00,52.00 116.09,52.00 112.35,53.34 110.00,47.00 110.00,47.00 102.00,47.00 102.00,47.00 Z M 139.00,47.00 C 139.00,47.00 139.00,68.00 139.00,68.00 139.00,68.00 130.00,68.00 130.00,68.00 130.00,68.00 130.00,74.00 130.00,74.00 130.00,74.00 156.00,74.00 156.00,74.00 156.00,74.00 156.00,68.00 156.00,68.00 156.00,68.00 147.00,68.00 147.00,68.00 147.00,68.00 147.00,47.00 147.00,47.00 147.00,47.00 139.00,47.00 139.00,47.00 Z M 119.00,57.00 C 119.00,57.00 116.00,66.00 116.00,66.00 116.00,66.00 113.00,57.00 113.00,57.00 113.00,57.00 119.00,57.00 119.00,57.00 Z M 155.00,125.20 C 138.85,121.97 122.49,119.81 106.00,120.00 106.00,120.00 97.00,120.83 97.00,120.83 75.79,122.86 55.34,126.35 35.00,133.00 35.00,133.00 44.40,177.00 44.40,177.00 45.00,180.01 46.60,191.43 48.59,192.98 50.33,194.32 53.94,193.96 56.00,193.72 56.00,193.72 71.00,193.00 71.00,193.00 71.00,193.00 87.00,192.00 87.00,192.00 87.00,192.00 134.00,192.00 134.00,192.00 134.00,192.00 155.00,193.00 155.00,193.00 158.98,193.02 169.56,195.25 172.02,192.40 173.45,190.73 175.37,178.07 176.00,175.00 176.00,175.00 185.00,133.00 185.00,133.00 177.14,130.06 163.43,126.89 155.00,125.20 Z M 28.00,189.00 C 28.00,189.00 28.00,256.00 28.00,256.00 28.00,257.84 27.88,261.14 28.60,262.78 30.29,266.60 40.08,269.38 44.00,270.00 44.00,270.00 44.00,203.00 44.00,203.00 43.98,187.21 35.09,173.13 29.00,159.00 27.07,163.87 28.00,182.62 28.00,189.00 Z M 184.70,173.00 C 180.50,182.30 176.05,191.63 176.00,202.00 176.00,202.00 176.00,225.00 176.00,225.00 176.00,225.00 176.00,270.00 176.00,270.00 180.08,269.36 189.65,266.81 191.40,262.79 192.12,261.13 192.00,257.86 192.00,256.00 192.00,256.00 192.00,159.00 192.00,159.00 188.48,163.43 186.98,167.93 184.70,173.00 Z M 79.00,228.00 C 79.00,228.00 79.00,244.00 79.00,244.00 79.00,244.00 141.00,244.00 141.00,244.00 141.00,244.00 141.00,228.00 141.00,228.00 141.00,228.00 79.00,228.00 79.00,228.00 Z M 28.00,296.00 C 28.00,296.00 28.00,347.00 28.00,347.00 28.00,347.00 44.00,342.00 44.00,342.00 44.00,342.00 44.00,286.00 44.00,286.00 43.94,276.05 41.12,278.71 29.00,272.00 29.00,272.00 28.00,296.00 28.00,296.00 Z M 176.57,280.39 C 175.92,281.80 176.01,284.43 176.00,286.00 176.00,286.00 176.00,342.00 176.00,342.00 176.00,342.00 192.00,347.00 192.00,347.00 192.00,347.00 192.00,272.00 192.00,272.00 188.48,273.49 178.08,277.16 176.57,280.39 Z M 64.00,284.00 C 64.00,284.00 64.00,290.00 64.00,290.00 64.00,290.00 73.00,290.00 73.00,290.00 73.00,290.00 73.00,311.00 73.00,311.00 73.00,311.00 81.00,311.00 81.00,311.00 81.00,311.00 81.00,290.00 81.00,290.00 81.00,290.00 90.00,290.00 90.00,290.00 90.00,290.00 90.00,284.00 90.00,284.00 90.00,284.00 64.00,284.00 64.00,284.00 Z M 99.51,285.02 C 99.51,285.02 95.81,292.00 95.81,292.00 95.81,292.00 89.00,311.00 89.00,311.00 94.41,310.98 96.65,311.88 98.00,306.00 103.91,306.00 107.65,304.66 110.00,311.00 110.00,311.00 118.00,311.00 118.00,311.00 118.00,311.00 109.00,284.00 109.00,284.00 109.00,284.00 99.51,285.02 99.51,285.02 Z M 122.00,284.00 C 122.00,284.00 129.53,297.42 129.53,297.42 129.53,297.42 122.00,311.00 122.00,311.00 130.03,310.97 131.15,310.45 135.00,303.00 142.01,311.14 140.35,310.99 150.00,311.00 150.00,311.00 142.21,297.00 142.21,297.00 142.21,297.00 149.00,284.00 149.00,284.00 140.92,284.03 139.72,284.44 136.00,292.00 130.86,284.80 130.76,284.03 122.00,284.00 Z M 152.00,284.00 C 152.00,284.00 152.00,311.00 152.00,311.00 152.00,311.00 160.00,311.00 160.00,311.00 160.00,311.00 160.00,284.00 160.00,284.00 160.00,284.00 152.00,284.00 152.00,284.00 Z M 107.00,301.00 C 107.00,301.00 101.00,301.00 101.00,301.00 101.00,301.00 103.00,292.00 103.00,292.00 103.00,292.00 107.00,301.00 107.00,301.00 Z M 29.02,355.51 C 29.02,355.51 28.00,361.00 28.00,361.00 28.00,361.00 28.00,410.00 28.00,410.00 33.33,406.18 40.49,399.23 42.86,393.00 44.42,388.87 44.00,382.50 44.00,378.00 44.00,378.00 44.00,350.00 44.00,350.00 44.00,350.00 29.02,355.51 29.02,355.51 Z M 192.00,362.00 C 191.94,352.77 190.50,354.50 177.00,350.00 175.34,355.83 176.00,362.90 176.00,369.00 176.00,373.51 175.65,387.53 176.56,391.00 178.33,397.80 186.43,406.01 192.00,410.00 192.00,410.00 192.00,362.00 192.00,362.00 Z M 44.01,438.00 C 44.32,450.41 53.24,456.46 64.00,460.30 70.36,462.57 79.25,464.19 86.00,464.83 86.00,464.83 102.00,465.83 102.00,465.83 102.00,465.83 128.00,465.00 128.00,465.00 137.41,464.95 147.10,463.48 156.00,460.30 162.93,457.83 170.55,453.81 174.00,447.00 177.40,440.28 176.27,434.00 175.00,427.00 168.90,430.07 165.78,435.28 151.00,439.97 137.97,444.11 127.41,443.00 114.00,443.00 98.27,443.00 80.83,444.56 66.00,438.94 55.91,435.10 54.19,432.79 46.00,427.00 43.76,430.86 43.91,433.62 44.01,438.00 Z",""];

  

  // var drivername=["<?php //echo  $All_driver_Name;?>"]


  //alert(drivername);
  var i, s, caArray = category_arr, len = caArray.length;


  var car = "M17.402,0H5.643C2.526,0,0,3.467,0,6.584v34.804c0,3.116,2.526,5.644,5.643,5.644h11.759c3.116,0,5.644-2.527,5.644-5.644 V6.584C23.044,3.467,20.518,0,17.402,0z M22.057,14.188v11.665l-2.729,0.351v-4.806L22.057,14.188z M20.625,10.773 c-1.016,3.9-2.219,8.51-2.219,8.51H4.638l-2.222-8.51C2.417,10.773,11.3,7.755,20.625,10.773z M3.748,21.713v4.492l-2.73-0.349 V14.502L3.748,21.713z M1.018,37.938V27.579l2.73,0.343v8.196L1.018,37.938z M2.575,40.882l2.218-3.336h13.771l2.219,3.336H2.575z M19.328,35.805v-7.872l2.729-0.355v10.048L19.328,35.805z";

                            
var i, s, caArray = category_arr, len = caArray.length;

    function LA() {}
    LA.token = "LnKsUy2B4VhxbcqnEDO5EbpFGSurDMeMbhQqc7B2";

    var category_arr = ["<?php echo $cat_implode; ?>"];
    var uid_name = ["<?php echo $cat_implode; ?>"];
    var uid_mob = ["<?php echo $driverid; ?>"];
    var uid = ["<?php echo $driverid; ?>"];
    var u_loc = ["<?php echo $finalData; ?>"];
if (jQuery.inArray('14seatervan', caArray)!='-1') {
      var icon = {
    path: car,
    scale: .7,
    strokeColor: 'white',
    strokeWeight: .10,
    fillOpacity: 1,
    fillColor: "#000000",
    offset: '5%',
    scaledSize: [25, 25]
    }

} else if (jQuery.inArray('Hatchback', caArray)!='-1') {
      var icon = {
    path: car,
    scale: .7,
    strokeColor: 'white',
    strokeWeight: .10,
    fillOpacity: 1,
    fillColor: "#FF0000",
    offset: '5%',
    scaledSize: [25, 25]
    }

} else if(jQuery.inArray('SUV', caArray)!='-1') {

 var icon = {
    path: car,
    scale: .7,
    strokeColor: 'white',
    strokeWeight: .10,
    fillOpacity: 1,
    fillColor: "#008000",
    offset: '5%',
    scaledSize: [25, 25]
    }

} else if(jQuery.inArray('Sedan', caArray)!='-1') {

 var icon = {
    path: car,
    scale: .7,
    strokeColor: 'white',
    strokeWeight: .10,
    fillOpacity: 1,
    fillColor: "#0000FF",
    offset: '5%',
    scaledSize: [25, 25]
    }

}


function load_map() {
  for (i=0; i<len; i++) {
    var firebaseRef_new = firebase.database().ref('drivers_location/'+caArray[i]);

    firebaseRef_new.on("child_added", function(snapshot, prevChildKey) {
      var getid = snapshot.getKey();
      var newPosition = snapshot.val();
      console.log(newPosition[i]);
      var latLng = new google.maps.LatLng(newPosition['l'][0],
      newPosition['l'][1]);
      marker = new google.maps.Marker({
        position: latLng,
        map: map,
        icon: icon
      });
      markers.push(marker);
      google.maps.event.addListener(marker, 'click', (function(marker, i) {
          return function() {
            firebase.database().ref('/drivers_status/' + getid).once('value').then(function(snapshot) {
              var driver_name = snapshot.val().fname;
              var displaytext= 'ID:'+ getid+',Driver Name:'+ driver_name;
              infowindow.setContent(displaytext);
            });
            infowindow.open(map, marker);
          }
      })(marker, i));
    });
    i++;  
  }
}
                        
load_map();

function map_data() {
  for (i=0; i<len; i++) {
    var len_uid = u_loc.length;
    var i, s, caArray = category_arr, len = caArray.length;
      for (j=0; j<len_uid; j++) {
        icon.fillColor = vectorC_arr[i];  
        icon.path = vector_arr[i];
        var latLng = new google.maps.LatLng(u_loc);
        var infodata = uid_name+"<br>"+uid_mob;
        var markerid = uid;
        console.log(markerid);
        marker[markerid] = new google.maps.Marker({
          position: latLng,
          map: map,
          title: infodata,
          icon: icon
        });

        marker[markerid].id = markerid;
        markers.push(marker[markerid]);
        markers_name.push(infodata);

        google.maps.event.addListener(marker[markerid], 'click', function(){
          infowindow.setContent(this.title);
          infowindow.open(map, this);
        });
                
        google.maps.event.addListener(marker, 'click', (function(marker, i) {
          return function() {
            firebase.database().ref('/drivers_status/' + markerid).once('value').then(function(snapshot) {
              var driver_name = snapshot.val().fname;
              var displaytext= 'ID:'+ markerid+',Driver Name:'+ driver_name;
              infowindow.setContent(displaytext);
            });         
            infowindow.open(map, marker);
          }
        })(marker, i));
    } 
}
}
                        map_data();

                        

                        function setMapOnAll(map)
                        {

                            for (var i = 0; i < markers.length; i++) 
                            {
                              markers[i].setMap(map);
                            }
                        }

                              // Removes the markers from the map, but keeps them in the array.
                        function clearMarkers() 
                        {
                           setMapOnAll(null);
                        }
                        function deleteMarkers() 
                        {
                           clearMarkers();
                          markers = [];
                        }
                        function DeleteMarker(id) 
                        {

                            //Find and remove the marker from the Array
                            for (var i = 0; i < markers.length; i++)
                             {

                              
                                if (markers[i].id == id) 
                                {
                                    //alert(markers[i].id);

                                  console.log(markers);
                                    //Remove the marker from Map                  
                                    markers[i].setMap(null);

                                    //Remove the marker from array.

                                         // alert(markers_name);

                                    markers.splice(i, 1);
                                    return markers_name[i];
                                }
                            }
                        };
                      //var commentsRef = firebase.database().ref().child('KZaEvq_mipwphn6wgmJ');
                        var infowindow = new google.maps.InfoWindow({

                                });

                        var m_name = "";

                     function update_map()
                    {


                 

                         var i, s, caArray = category_arr, len = caArray.length;


                          for (i=0; i<len; ++i)
                          {


                              if (i in caArray) 
                              {

                                var geoFire = new GeoFire(firebaseRef);

                                 if(caArray[i] !='null')
                                {
                                  

                                var firebaseRef_ch = firebase.database().ref('drivers_location/'+caArray[i]);
                                }


                                firebaseRef_ch.on('child_changed', function(snapshot, prevChildKey) {





                                        var getid = snapshot.getKey();

                                        //var getname= drivername;

                                        //alert(getname);

                                        var newPosition =snapshot.val();

                                        console.log(newPosition);

                                        // console.log(snapshot.getPriority());
                                        //console.log(snapshot.name());
                                        var arr = Object.keys(newPosition).map(function(k) { return newPosition[k] });
                                        //console.log(arr);
                                        /*if( 'l' in arr[caArray[i]][0] )  {
                                        markers_temp = markers ;
                                        deleteMarkers();
                                        }*/
                                        //markers_temp = markers ;
                                        // deleteMarkers();
                                        DeleteMarker(getid);
                                        //  var m_name = DeleteMarker(getid);
                                        //var userId = firebase.auth().currentUser.uid;
                                        //get_name(getid);

                                        m_name = getid;

                                        firebase.database().ref('/drivers_location/' + getid).once('value').then(function(snapshot) {
                                        //m_name = snapshot.val().name;

                                        //m_name = getid;

                                        // ...
                                        });
                                        //console.log(caArray[i]);
                                        // markers[getid].setMap(null);

                                        //console.log(Object.keys(newPosition).length)
                                        // console.log(Object.keys(newPosition)[0][0].lat);

                                        //  for (var i = 0; i < Object.keys(newPosition).length; i++) {

                                        // if( 'l' in arr[i] )  {
                                        //console.log(arr[i]['l'][0]);

                                        console.log(newPosition.l[0],newPosition.l[1]);

                                        //alert(newPosition);

                                        console.log(newPosition.bearing);

                                        //alert(newPosition);
                                        icon.rotation = parseInt(newPosition.bearing);

                                        //icon.rotation = parseInt("10");


                                       


                                       marker[getid] = new google.maps.Marker({

                                        position: new google.maps.LatLng(newPosition.l[0],newPosition.l[1]),
                                        map: map,
                                        title : m_name,
                                         icon: icon

                                        });
                                      
                                       /* marker[getid] = new google.maps.Marker({

                                        position: new google.maps.LatLng(newPosition.l[0],newPosition.l[1]),
                                        map: map,
                                        title : m_name,
                                         icon: icon

                                        });*/
                                        marker[getid].id = getid;
                                        markers.push(marker[getid]);

                                          google.maps.event.addListener(marker[getid], 'click', function(){

                                          firebase.database().ref('/drivers_status/' + getid).once('value').then(function(snapshot) {
                                             var driver_name = snapshot.val().fname;


                                             var displaytext= 'ID:'+ getid+',Driver Name:'+ driver_name;

                                        infowindow.setContent(displaytext);
                                        });
                                        infowindow.open(map, this);

                                        
                                        });
                                        /*google.maps.event.addListener(marker, 'click', (function(marker, i) {
                                        return function() {
                                        infowindow.setContent(arr[i]['Name']);
                                        infowindow.open(map, marker);
                                        }
                                        })(marker, i));*/
                                        // }
                                        //markers.push(marker);
                                        //  }
                                        });
                                   } 
                              }
                          //i++;

                    }

                    //setInterval(function(){update_map(); }, 3000);

                    update_map();
                    google.maps.event.addDomListener(window, "load");